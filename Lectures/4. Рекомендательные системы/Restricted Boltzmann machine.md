### <u>Метод Restricted Boltzmann machine</u>



Еще одним методом построения рекомендаций на основе нейронных сетей является ***Restricted Boltzmann machine.***



***Архитектура BM / RBM***

![img](https://lms.skillfactory.ru/assets/courseware/v1/48782680bf8835660d0eefeb0e05f857/asset-v1:Skillfactory+MLO-18+29OCT2019+type@asset+block/ml9_18.jpg)

Архитектура сети ***RBM*** состоит из двух слоев — видимого и скрытого. При том связи между нейронами в рамках одного слоя запрещены. 

***Интерпретация архитектуры***

- - Есть ряд состояний, которые мы можем наблюдать.
  - Есть ряд состояний, которые скрыты. 
  - Мы можем сделать вероятностный вывод относительно скрытых состояний, опираясь на состояния, которые мы можем наблюдать.
  - После обучения получаем возможность делать выводы относительно видимых состояний, зная скрытые.
  - Т.о получаем возможность генерировать данные из вероятностного распределения, на котором обучена модель.

Если рассмотреть пример на основе фильмов и рекомендаций для пользователя, то видимый слой будет состоять из всего множества фильмов, которые посмотрел человек, а скрытый слой может соответствовать различным жанрам фильма, например, комедия. 

![img](https://lms.skillfactory.ru/assets/courseware/v1/06d378c30a4f34346d88289e6f4dcc73/asset-v1:Skillfactory+MLO-18+29OCT2019+type@asset+block/ml9_19.png)

***Процесс тренировки:***

- - Если пользователь купил продукт, то соотв. нейрон видимого слоя активируется
  - Состояния нейронов видимого слоя подаются на вход скрытого слоя 
  - Вычисляются состояния скрытого слоя
  - Состояния скрытого слоя подаются на вход видимого слоя и состояния нейронов видимого слоя пересчитывается 
  - Разность между текущим состоянием видимого слоя и прошлым состоянием используется для обновления весов связей между нейронами

![img](https://lms.skillfactory.ru/assets/courseware/v1/b5906b7588e54809d1e230fee2313b47/asset-v1:Skillfactory+MLO-18+29OCT2019+type@asset+block/ml9_20.jpg)

***Для вычислений рекомендаций на RBM:***

- - Состояние видимого слоя соотв. продуктам пользователя 
  - На основе состояния видимого слоя и натренированных весов, вычисляется состояние скрытого слоя
  - Состояния скрытого слоя используются для пересчета состояния видимого слоя
  - Вероятности активации видимого слоя используются как рейтинги рекомендаций

На основании такой архитектуры был выигран приз в конкурсе Netflix.

**2007** Netflix Progress Prize:

*SVD - Prize RMSE: 0.8914* 

*RBM - Prize RMSE: 0.8990*

В **2014** году Netflix для рекомендаций использовал ансамбль с RBM:

![img](https://lms.skillfactory.ru/assets/courseware/v1/48782680bf8835660d0eefeb0e05f857/asset-v1:Skillfactory+MLO-18+29OCT2019+type@asset+block/ml9_18.jpg)